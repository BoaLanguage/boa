ODIR=bin
SDIR=src 
MAIN := boa
OBJS := ast.cmo lexer.cmo parser.cmo pprint.cmo eval.cmo check.cmo main.cmo

%.cmo: %.ml
	ocamlc -c $<

%.cmi: %.mli
	ocamlc -c $<

$(MAIN): $(OBJS)
	ocamlc -o $@ $^

lexer.ml: $(SDIR)/lexer.mll
	ocamllex -q $<

parser.ml: $(SDIR)/parser.mly
	ocamlyacc -v $<

parser.mli: $(SDIR)/parser.mly
	ocamlyacc -v $<

clean:
	rm -f $(ODIR)/*.cmo $(ODIR)/*.cmi $(SDIR)/lexer.ml $(SDIR)/parser.ml $(SDIR)/parser.mli $(MAIN)

# Dependencies generated by `ocamldep -bytecode *.mli *.ml`.
ast.cmo :
check.cmo : ast.cmo
eval.cmo : ast.cmo pprint.cmo
lexer.cmo : parser.cmi
main.cmo : pprint.cmo parser.cmi lexer.cmo eval.cmo check.cmo ast.cmo
parser.cmo : ast.cmo parser.cmi
parser.cmi : ast.cmo
pprint.cmo : ast.cmo